(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{564:function(e,t,o){var content=o(729);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(120).default)("cffc8a6c",content,!0,{sourceMap:!1})},728:function(e,t,o){"use strict";o(564)},729:function(e,t,o){var r=o(119)((function(i){return i[1]}));r.push([e.i,'.overview__header[data-v-7f61d4e0]{align-items:center;display:flex;justify-content:space-between;margin-bottom:1rem}.title-container[data-v-7f61d4e0]{align-items:center;display:flex;gap:.5rem}.header-spinner[data-v-7f61d4e0]{margin-left:.5rem}.overview__button[data-v-7f61d4e0]{border:none;border-radius:4px;color:#fff;cursor:pointer;font-size:.875rem;padding:.5rem 1rem;transition:background-color .2s}.overview__button[data-v-7f61d4e0],.overview__button[data-v-7f61d4e0]:hover{background-color:#333}.overview__table-container[data-v-7f61d4e0]{background-color:#fff;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,.1);margin-bottom:2rem;overflow-x:auto;padding:1rem}.overview__table[data-v-7f61d4e0]{border-collapse:collapse;width:100%}.overview__table td[data-v-7f61d4e0],.overview__table th[data-v-7f61d4e0]{border-bottom:1px solid #edf2f0;padding:.75rem 1rem;text-align:left}.overview__table thead th[data-v-7f61d4e0]{background-color:#f7fafc;color:#4a5568;font-size:.875rem;font-weight:600}.overview__table tbody tr[data-v-7f61d4e0]:hover{background-color:#f7fafc}.overview__empty[data-v-7f61d4e0]{color:#718096;padding:2rem!important;text-align:center}.action-buttons[data-v-7f61d4e0]{display:flex;gap:.5rem}.action-button[data-v-7f61d4e0]{border:none;border-radius:4px;cursor:pointer;font-size:.75rem;padding:.25rem .5rem}.action-button--view[data-v-7f61d4e0]{background-color:#ebf8ff;color:#2b6cb0}.action-button--view[data-v-7f61d4e0]:hover{background-color:#bee3f8}.action-button--edit[data-v-7f61d4e0]{background-color:#e6fffa;color:#2c5282}.action-button--edit[data-v-7f61d4e0]:hover{background-color:#b2f5ea}.action-button--reject[data-v-7f61d4e0]{background-color:#fff5f5;color:#c53030}.action-button--reject[data-v-7f61d4e0]:hover{background-color:#fed7d7}.action-button--cancel[data-v-7f61d4e0]{background-color:#fffaf0;color:#c05621}.action-button--cancel[data-v-7f61d4e0]:hover{background-color:#feebc8}.form-section[data-v-7f61d4e0]{margin-bottom:1.5rem;text-align:left;width:100%}.section-title[data-v-7f61d4e0]{color:#4a5568;font-size:1rem;font-weight:600;margin-bottom:.75rem}.form-row[data-v-7f61d4e0]{display:flex;flex-wrap:wrap;margin:0 -.5rem}.form-group[data-v-7f61d4e0],.form-row[data-v-7f61d4e0]{box-sizing:border-box;width:100%}.form-group[data-v-7f61d4e0]{margin-bottom:1rem;padding:0 .5rem}.form-group--half[data-v-7f61d4e0]{width:50%}@media (max-width:767px){.form-group--half[data-v-7f61d4e0]{width:100%}}.kam-input[data-v-7f61d4e0]{box-sizing:border-box;width:100%}.form-group--third[data-v-7f61d4e0]{width:calc(33.333% - .5rem)}@media (max-width:767px){.form-group--third[data-v-7f61d4e0]{width:100%}}.modal-buttons[data-v-7f61d4e0]{display:flex;gap:1rem;justify-content:center;margin-top:2rem}input[data-v-7f61d4e0]{border:1px solid #e2e8f0;border-radius:.375rem;padding:.625rem .75rem;transition:all .2s;width:100%}input[data-v-7f61d4e0]:focus{border-color:#333;box-shadow:0 0 0 3px rgba(59,130,246,.1);outline:none}.emoji-btn[data-v-7f61d4e0]{background:#fff;border:1px solid #e2e8f0;border-radius:.375rem;cursor:pointer;font-weight:500;min-width:120px;padding:.625rem 1.25rem;transition:all .2s}.emoji-btn[data-v-7f61d4e0]:hover{background:#f8fafc;border-color:#cbd5e1}.emoji-btn.save-btn[data-v-7f61d4e0]{background-color:#4a5568;border-color:#4a5568;color:#fff}.emoji-btn.save-btn[data-v-7f61d4e0]:hover{background-color:#2d3748}.emoji-btn.save-btn[data-v-7f61d4e0]:disabled{background-color:#a0aec0;border-color:#a0aec0;cursor:not-allowed}.emoji-btn.cancel-btn[data-v-7f61d4e0]:hover{background-color:#f7fafc;border-color:#e2e8f0}textarea[data-v-7f61d4e0]{border:1px solid #e2e8f0;border-radius:.375rem;padding:.625rem .75rem;resize:vertical;transition:all .2s;width:100%}textarea[data-v-7f61d4e0]:focus{border-color:#333;box-shadow:0 0 0 3px rgba(59,130,246,.1);outline:none}.vat-input-container[data-v-7f61d4e0]{align-items:center;display:flex;justify-content:center;margin:0 auto;max-width:600px}.lookup-btn[data-v-7f61d4e0]{font-size:1rem;height:100%;padding:.625rem 1.25rem;white-space:nowrap}.offer-items-selection[data-v-7f61d4e0]{grid-gap:.75rem;display:grid;gap:.75rem;margin-top:1rem}.offer-item-checkbox[data-v-7f61d4e0]{align-items:center;background-color:#fff;border:1px solid #e2e8f0;border-radius:.5rem;box-shadow:0 1px 3px rgba(0,0,0,.1);display:flex;padding:.75rem 1rem;transition:all .2s;width:100%}.offer-item-checkbox[data-v-7f61d4e0]:hover{background-color:#f7fafc;border-color:#cbd5e1;box-shadow:0 2px 4px rgba(0,0,0,.1)}.offer-item-checkbox label[data-v-7f61d4e0]{cursor:pointer;flex:1;font-size:1.05rem;margin-bottom:0;text-align:left}.quantity-selector[data-v-7f61d4e0]{align-items:center;display:flex;flex-wrap:wrap;gap:.75rem;justify-content:flex-end;margin-left:auto}.quantity-selector label[data-v-7f61d4e0]{font-size:.9rem;font-weight:500;margin-bottom:0;white-space:nowrap}.quantity-input[data-v-7f61d4e0]{border:1px solid #e2e8f0;border-radius:.25rem;font-size:1rem;padding:.5rem;text-align:center;width:10rem}.price-input-wrapper[data-v-7f61d4e0]{border:none;width:10rem}.price-input-wrapper[data-v-7f61d4e0] .price-input-container{width:100%}.price-input-wrapper[data-v-7f61d4e0] .price-input{font-size:1rem;padding:.5rem 1.5rem .5rem .5rem;text-align:center;width:100%}.fee-input[data-v-7f61d4e0]:focus,.price-input-wrapper[data-v-7f61d4e0] .price-input:focus{border-color:#4a5568;box-shadow:0 0 0 2px rgba(74,85,104,.2);outline:none}.preview-container[data-v-7f61d4e0]{border:1px solid #e2e8f0;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,.1);margin-bottom:5px;position:relative}.scrollable-document-container[data-v-7f61d4e0]{max-height:70vh;overflow-y:auto;padding-top:10px}.visible-loader[data-v-7f61d4e0]{background-color:hsla(0,0%,100%,.9);border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.2);left:50%;padding:20px;position:fixed;top:50%;transform:translate(-50%,-50%);z-index:1000}.custom-checkbox[data-v-7f61d4e0]{height:32px;margin-right:1rem;min-width:32px;position:relative}.custom-checkbox-input[data-v-7f61d4e0]{cursor:pointer;height:0;opacity:0;position:absolute;width:0}.custom-checkbox-label[data-v-7f61d4e0]{background-color:#fff;border:2px solid #4a5568;border-radius:6px;box-shadow:0 1px 3px rgba(0,0,0,.1);cursor:pointer;height:32px;left:0;position:absolute;top:0;transition:all .2s;width:32px}.custom-checkbox-label[data-v-7f61d4e0]:hover{background-color:#f7fafc;border-color:#2d3748;box-shadow:0 2px 4px rgba(0,0,0,.1)}.custom-checkbox-input:checked+.custom-checkbox-label[data-v-7f61d4e0]{background-color:#4a5568;border-color:#2d3748}.custom-checkbox-input:checked+.custom-checkbox-label[data-v-7f61d4e0]:after{border:solid #fff;border-width:0 3px 3px 0;content:"";height:16px;left:9px;position:absolute;top:3px;transform:rotate(45deg);width:8px}.status-badge[data-v-7f61d4e0]{border-radius:9999px;display:inline-block;font-size:.75rem;font-weight:500;padding:.25rem .5rem}.status-badge--created[data-v-7f61d4e0]{background-color:#e2e8f0;color:#4a5568}.status-badge--sent[data-v-7f61d4e0]{background-color:#bee3f8;color:#2c5282}.status-badge--read[data-v-7f61d4e0]{background-color:#c6f6d5;color:#276749}.status-badge--accepted[data-v-7f61d4e0]{background-color:#9ae6b4;color:#22543d}.status-badge--registered[data-v-7f61d4e0]{background-color:#faf089;color:#744210}.status-badge--rejected[data-v-7f61d4e0]{background-color:#fed7d7;color:#9b2c2c}.status-badge--cancelled[data-v-7f61d4e0]{background-color:#f7d2c4;color:#e67e73}.status-table[data-v-7f61d4e0]{border-collapse:collapse;margin-top:.5rem;table-layout:fixed;width:100%}.status-row[data-v-7f61d4e0]{border-bottom:1px solid #e2e8f0;display:flex}.status-row[data-v-7f61d4e0]:last-child{border-bottom:none}.status-cell[data-v-7f61d4e0]{flex:1;overflow:hidden;padding:.5rem;text-align:left;text-overflow:ellipsis}.status-cell--label[data-v-7f61d4e0]{background-color:#f7fafc;color:#4a5568;flex:0 0 150px;font-weight:700;min-width:150px;text-align:left;width:150px}.status-cell--span3[data-v-7f61d4e0]{flex:3}@media (max-width:767px){.status-row[data-v-7f61d4e0]{flex-wrap:wrap}.status-cell[data-v-7f61d4e0]{flex:1 0 50%}.status-cell--label[data-v-7f61d4e0]{flex:0 0 100px;min-width:100px;width:100px}.status-cell--span3[data-v-7f61d4e0]{flex:1 0 calc(100% - 100px)}}.price-input-group[data-v-7f61d4e0]{align-items:flex-start;display:flex;flex-direction:column;margin-top:.5rem}.price-input-group label[data-v-7f61d4e0]{margin-bottom:.25rem}',""]),r.locals={},e.exports=r},840:function(e,t,o){"use strict";o.r(t);o(42),o(37),o(27),o(29),o(28),o(41),o(51),o(52);var r=o(0),n=o(10),l=(o(9),o(73),o(13),o(33),o(26),o(62),o(196),o(57),o(61),o(68),o(307),o(494)),c=o(495),d=o(502),f=o(595),m=o(594),v=o(67);function h(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}var P={components:{AdminPage:l.default,Loading:c.default,Modal:d.default,OfferDocument:f.default,PriceInput:m.default},data:function(){return{isLoading:!0,offerProposals:[],showProposalModal:!1,showViewProposalModal:!1,showDeleteProposalModal:!1,showCancelProposalModal:!1,currentProposal:new v.f,viewingProposal:null,proposalToDelete:null,proposalToCancel:null,isEditingProposal:!1,proposalStep:1,selectedOfferItems:[],lineItems:{},offerItems:[],isLookingUp:!1,isSubmitting:!1,isSendingSms:!1,isSendingEmail:!1,refreshInterval:null}},computed:{isProposalValid:function(){return this.currentProposal.companyVAT&&this.currentProposal.clientName&&this.currentProposal.clientPhoneNumber&&this.currentProposal.companyLegalName&&this.selectedOfferItems.length>0}},mounted:function(){var e=this;this.fetchOfferProposals(),this.fetchOfferItems(),this.refreshInterval=setInterval((function(){e.fetchDataInBackground()}),1e4)},beforeDestroy:function(){this.refreshInterval&&clearInterval(this.refreshInterval)},methods:{fetchOfferProposals:function(){var e=this;this.isLoading=!0,this._offerProposalService.GetAll().then((function(data){e.offerProposals=data})).finally((function(){e.isLoading=!1}))},fetchDataInBackground:function(){var e=this;this._offerProposalService.GetAll().then((function(data){e.offerProposals=data})),this._offerService.GetAll().then((function(data){e.offerItems=data}))},fetchOfferItems:function(){var e=this;this._offerService.GetAll().then((function(data){e.offerItems=data})).catch((function(e){console.error("Error fetching offer items:",e)}))},showCreateProposalModal:function(){this.isEditingProposal=!1,this.currentProposal={clientName:"",clientEmail:"",clientPhoneNumber:"",companyLegalName:"",companyVAT:"",companyFullAddress:"",companyZipCode:"",companyCity:""},this.selectedOfferItems=[],this.lineItems={},this.proposalStep=1,this.showProposalModal=!0},editProposal:function(e){var t=this;this.isEditingProposal=!0,this.currentProposal=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?h(Object(o),!0).forEach((function(t){Object(n.a)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):h(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},e),this.selectedOfferItems=[],this.lineItems={},e.lineItems&&e.lineItems.length>0&&e.lineItems.forEach((function(e){t.selectedOfferItems.push(e.originalOfferItemId),t.lineItems[e.originalOfferItemId]={quantity:e.quantity||1,monthlyFee:e.monthlyFee,onetimeFee:e.onetimeFee}})),this.proposalStep=2,this.showProposalModal=!0},closeProposalModal:function(){this.showProposalModal=!1},lookupCompanyInfo:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.currentProposal.companyVAT){t.next=3;break}return alert("Skriv inn organisasjonsnummeret først, er du snill 😃"),t.abrupt("return");case 3:return e.isLookingUp=!0,t.prev=4,o=e.currentProposal.companyVAT.trim().replace(/\D/g,""),e.currentProposal.companyVAT=o,t.next=9,e._storeService.GetBrregData(o);case 9:r=t.sent,e.currentProposal.companyLegalName=r.name||"",e.currentProposal.companyFullAddress=r.fullAddress||"",e.currentProposal.companyZipCode=r.zipCode||"",e.currentProposal.companyCity=r.city||"",e.proposalStep=2,t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),console.error("Failed to get company data:",t.t0),e.proposalStep=2;case 21:return t.prev=21,e.isLookingUp=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[4,17,21,24]])})))()},isItemSelected:function(e){return this.selectedOfferItems.includes(e)},getLineItemQuantity:function(e){var t;return(null===(t=this.lineItems[e])||void 0===t?void 0:t.quantity)||1},updateLineItems:function(){var e=this,t={};this.selectedOfferItems.forEach((function(o){var r=e.offerItems.find((function(e){return e.offerItemId===o}));e.lineItems[o]?(t[o]={quantity:e.lineItems[o].quantity||1,monthlyFee:e.lineItems[o].monthlyFee,onetimeFee:e.lineItems[o].onetimeFee},console.log("updateLineItems - Existing item ".concat(o,", preserving values:"),t[o])):(t[o]={quantity:1,monthlyFee:r?r.maxMonthlyFee:0,onetimeFee:r?r.maxOnetimeFee:0},console.log("updateLineItems - New item ".concat(o,", setting defaults:"),t[o]))})),this.lineItems=t},saveProposal:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o,r,n,l,c,d,f,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isProposalValid){t.next=3;break}return alert("🫨 Du er litt for kjapp! Fyll ut alle feltene og velg minst én vare eller tjeneste først."),t.abrupt("return");case 3:if(!e.isSubmitting){t.next=5;break}return t.abrupt("return");case 5:return e.isSubmitting=!0,console.log("saveProposal - Starting save with lineItems:",JSON.stringify(e.lineItems)),o=new v.f,e.isEditingProposal&&e.currentProposal.offerProposalId&&(o.offerProposalId=e.currentProposal.offerProposalId),o.clientName=e.currentProposal.clientName,o.clientEmail=e.currentProposal.clientEmail,o.clientPhoneNumber=e.currentProposal.clientPhoneNumber,o.companyLegalName=e.currentProposal.companyLegalName,o.companyVAT=e.currentProposal.companyVAT,o.companyFullAddress=e.currentProposal.companyFullAddress,o.companyZipCode=e.currentProposal.companyZipCode,o.companyCity=e.currentProposal.companyCity,o.lineItems=[],e.selectedOfferItems.forEach((function(t){if(e.offerItems.find((function(e){return e.offerItemId===t}))){var r,n,l,c=new v.e;c.originalOfferItemId=t,c.offerItemId=t,c.quantity=Number(null===(r=e.lineItems[t])||void 0===r?void 0:r.quantity)||1,c.monthlyFee=null===(n=e.lineItems[t])||void 0===n?void 0:n.monthlyFee,c.onetimeFee=null===(l=e.lineItems[t])||void 0===l?void 0:l.onetimeFee,console.log("saveProposal - Adding line item for ".concat(t,":"),{quantity:c.quantity,monthlyFee:c.monthlyFee,onetimeFee:c.onetimeFee}),o.lineItems.push(c)}})),r=e.isEditingProposal?e.currentProposal.offerProposalId:0,t.prev=20,t.next=23,e._offerProposalService.CreateOrUpdateOfferProposal(r,o);case 23:if(n=t.sent,l=(null==n?void 0:n.offerProposalId)||(e.isEditingProposal?r:null),e.closeProposalModal(),!l){t.next=45;break}return t.next=29,e.fetchOfferProposals();case 29:if(c=e.offerProposals.find((function(p){return p.offerProposalId===l}))){t.next=42;break}return t.prev=31,t.next=34,e._offerProposalService.GetAll();case 34:d=t.sent,(c=d.find((function(p){return p.offerProposalId===l})))&&(e.offerProposals=d),t.next=42;break;case 39:t.prev=39,t.t0=t.catch(31),console.error("Error fetching all proposals:",t.t0);case 42:c?e.viewProposal(c):(console.error("Could not find the created proposal in the updated list"),alert("Avtalen ble opprettet, men kunne ikke vise detaljer. Oppdater siden for å se den nye avtalen.")),t.next=47;break;case 45:console.error("No proposal ID returned from save operation"),alert("Avtalen ble opprettet, men kunne ikke vise detaljer. Oppdater siden for å se den nye avtalen.");case 47:t.next=53;break;case 49:t.prev=49,t.t1=t.catch(20),console.error("Error saving proposal:",t.t1),null!==t.t1&&void 0!==t.t1&&null!==(f=t.t1.response)&&void 0!==f&&f.data?alert(null===t.t1||void 0===t.t1||null===(m=t.t1.response)||void 0===m?void 0:m.data):alert(t.t1.message||"En ukjent feil oppstod ved lagring av avtalen");case 53:return t.prev=53,e.isSubmitting=!1,t.finish(53);case 56:case"end":return t.stop()}}),t,null,[[20,49,53,56],[31,39]])})))()},getStatusLabel:function(e){switch(e){case"Created":return"Ikke sendt";case"Sent":return"Sendt";case"Read":return"Lest";case"Accepted":return"Akseptert";case"StoreRegistered":return"Registrert";case"Rejected":return"Avvist";case"Cancelled":return"Oppsagt";default:return e}},getStatusClass:function(e){switch(e){case"Created":return"status-badge status-badge--created";case"Sent":return"status-badge status-badge--sent";case"Read":return"status-badge status-badge--read";case"Accepted":return"status-badge status-badge--accepted";case"StoreRegistered":return"status-badge status-badge--registered";case"Rejected":return"status-badge status-badge--rejected";case"Cancelled":return"status-badge status-badge--cancelled";default:return"status-badge"}},calculateTotalMonthly:function(e){if(!e||!e.lineItems)return this.priceLabel(0);var t=e.lineItems.reduce((function(e,t){return t.monthlyFee?e+t.monthlyFee/100*t.quantity:e}),0);return this.priceLabel(t)},calculateTotalOnetime:function(e){if(!e||!e.lineItems)return this.priceLabel(0);var t=e.lineItems.reduce((function(e,t){return t.onetimeFee?e+t.onetimeFee/100*t.quantity:e}),0);return this.priceLabel(t)},calculateTotalMonthlyValue:function(e){return e&&e.lineItems?e.lineItems.reduce((function(e,t){return t.monthlyFee?e+t.monthlyFee/100*t.quantity:e}),0):0},calculateTotalOnetimeValue:function(e){return e&&e.lineItems?e.lineItems.reduce((function(e,t){return t.onetimeFee?e+t.onetimeFee/100*t.quantity:e}),0):0},sendProposalSms:function(){var e=this;this.viewingProposal&&this.viewingProposal.offerProposalId?this.isSendingSms||(this.isSendingSms=!0,this.isLoading=!0,this._offerProposalService.SendProposalSms(this.viewingProposal.offerProposalId).then((function(){e.closeViewProposalModal(),e.fetchOfferProposals()})).catch((function(e){console.error("Error sending SMS:",e),alert("Kunne ikke sende SMS: "+(e.message||"Ukjent feil"))})).finally((function(){e.isLoading=!1,e.isSendingSms=!1}))):alert("Kunne ikke sende SMS: Mangler avtale-ID")},sendProposalEmail:function(){var e=this;this.viewingProposal&&this.viewingProposal.offerProposalId?this.isSendingEmail||(this.isSendingEmail=!0,this.isLoading=!0,this._offerProposalService.SendProposalEmail(this.viewingProposal.offerProposalId).then((function(){e.closeViewProposalModal(),e.fetchOfferProposals()})).catch((function(e){console.error("Error sending Email:",e),alert("Kunne ikke sende E-post: "+(e.message||"Ukjent feil"))})).finally((function(){e.isLoading=!1,e.isSendingEmail=!1}))):alert("Kunne ikke sende E-post: Mangler avtale-ID")},editViewingProposal:function(){this.editProposal(this.viewingProposal),this.closeViewProposalModal()},viewProposal:function(e){var t=this;if(console.log("viewProposal called with:",e),console.log("Proposal code:",e.code),console.log("Proposal ID:",e.offerProposalId),!e.code&&(console.error("ERROR: Proposal code is missing or undefined!"),e.offerProposalId))return console.log("Attempting to fetch proposal details by ID instead of code"),this.isLoading=!0,void this._offerProposalService.GetAll().then((function(o){var r=o.find((function(p){return p.offerProposalId===e.offerProposalId}));r&&r.code?(console.log("Found proposal with code by ID:",r),t.viewProposal(r)):(console.error("Could not find proposal with code even after fetching all proposals"),alert("Kunne ikke hente avtaledetaljer - manglende kode"))})).catch((function(e){console.error("Error fetching all proposals:",e)})).finally((function(){t.isLoading=!1}));this.isLoading=!0,this._offerProposalService.GetByCode(e.code).then((function(e){console.log("GetByCode response:",e),t.viewingProposal=e,t.showViewProposalModal=!0,console.log("View modal should be visible now, showViewProposalModal =",t.showViewProposalModal)})).catch((function(e){console.error("Error fetching proposal details:",e),alert("Kunne ikke hente avtaledetaljer")})).finally((function(){t.isLoading=!1}))},closeViewProposalModal:function(){this.showViewProposalModal=!1,this.viewingProposal=null},rejectProposal:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t.proposalToDelete=e,t.showDeleteProposalModal=!0;case 2:case"end":return o.stop()}}),o)})))()},closeDeleteProposalModal:function(){this.showDeleteProposalModal=!1,this.proposalToDelete=null},confirmDeleteProposal:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,e._offerProposalService.RejectProposal(e.proposalToDelete.offerProposalId);case 4:e.fetchOfferProposals(),e.closeDeleteProposalModal(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error rejecting proposal:",t.t0),alert("Kunne ikke slette avtalen. Vennligst prøv igjen senere.");case 12:return t.prev=12,e.isLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,8,12,15]])})))()},cancelProposalConfirmation:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t.proposalToCancel=e,t.showCancelProposalModal=!0;case 2:case"end":return o.stop()}}),o)})))()},closeCancelProposalModal:function(){this.showCancelProposalModal=!1,this.proposalToCancel=null},confirmCancelProposal:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,e._offerProposalService.CancelProposal(e.proposalToCancel.offerProposalId);case 4:e.fetchOfferProposals(),e.closeCancelProposalModal(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error canceling proposal:",t.t0),alert("Kunne ikke si opp avtalen. Vennligst prøv igjen senere.");case 12:return t.prev=12,e.isLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,8,12,15]])})))()}}},w=P,y=(o(728),o(78)),component=Object(y.a)(w,(function(){var e,t,o=this,r=o._self._c;return r("AdminPage",{attrs:{"full-width":!0}},[r("div",{staticClass:"overview"},[r("div",{staticClass:"overview__content"},[r("div",{staticClass:"overview__table-container"},[r("div",{staticClass:"overview__header"},[r("div",{staticClass:"title-container"},[r("h3",[o._v("Avtaler")]),o._v(" "),o.isLoading?r("Loading",{staticClass:"header-spinner"}):o._e()],1),o._v(" "),r("button",{staticClass:"overview__button",on:{click:o.showCreateProposalModal}},[o._v("\n            Opprett avtale\n          ")])]),o._v(" "),r("table",{staticClass:"overview__table"},[r("thead",[r("tr",[r("th",{staticClass:"sortable-header"},[o._v("Kode")]),o._v(" "),r("th",{staticClass:"sortable-header"},[o._v("Kunde")]),o._v(" "),r("th",{staticClass:"sortable-header"},[o._v("Firma")]),o._v(" "),r("th",{staticClass:"sortable-header"},[o._v("Status")]),o._v(" "),r("th",{staticClass:"sortable-header"},[o._v("Opprettet")]),o._v(" "),r("th",{staticClass:"sortable-header"},[o._v("Endret")]),o._v(" "),r("th",{staticClass:"sortable-header"},[o._v("Selger")]),o._v(" "),r("th",[o._v("Handling")])])]),o._v(" "),r("tbody",[o._l(o.offerProposals,(function(e){return r("tr",{key:e.offerProposalId},[r("td",[o._v(o._s(e.code))]),o._v(" "),r("td",[o._v(o._s(e.clientName))]),o._v(" "),r("td",[o._v(o._s(e.companyLegalName))]),o._v(" "),r("td",[r("span",{class:o.getStatusClass(e.status)},[o._v("\n                  "+o._s(o.getStatusLabel(e.status))+"\n                ")])]),o._v(" "),r("td",[o._v(o._s(o.formatDate(e.createdAt)))]),o._v(" "),r("td",[o._v(o._s(o.formatDate(e.updatedAt)))]),o._v(" "),r("td",[o._v(o._s(e.sellerName||"-"))]),o._v(" "),r("td",[r("div",{staticClass:"action-buttons"},[r("button",{staticClass:"action-button action-button--view",on:{click:function(t){return o.viewProposal(e)}}},[o._v("\n                    Vis\n                  ")]),o._v(" "),"Created"===e.status||"Sent"===e.status||"Read"===e.status?r("button",{staticClass:"action-button action-button--edit",on:{click:function(t){return o.editProposal(e)}}},[o._v("\n                    Endre\n                  ")]):o._e(),o._v(" "),"Created"===e.status||"Sent"===e.status||"Read"===e.status?r("button",{staticClass:"action-button action-button--reject",on:{click:function(t){return o.rejectProposal(e)}}},[o._v("\n                    Slett\n                  ")]):o._e(),o._v(" "),"StoreRegistered"===e.status||"Accepted"===e.status?r("button",{staticClass:"action-button action-button--cancel",on:{click:function(t){return o.cancelProposalConfirmation(e)}}},[o._v("\n                    Si opp\n                  ")]):o._e()])])])})),o._v(" "),0===o.offerProposals.length?r("tr",[r("td",{staticClass:"overview__empty",attrs:{colspan:"8"}},[o._v("\n                Ingen avtaler funnet\n              ")])]):o._e()],2)])]),o._v(" "),o.showProposalModal?r("Modal",{attrs:{wide:!0},on:{close:o.closeProposalModal}},[r("div",{staticStyle:{width:"1000px","max-width":"90vw",margin:"0 auto","text-align":"center"}},[r("h1",{staticStyle:{"margin-bottom":"1em"}},[o._v("\n            "+o._s(o.isEditingProposal?"Endre avtale":"Opprett ny avtale")+"\n          ")]),o._v(" "),1===o.proposalStep?r("div",[r("div",{staticClass:"form-group"},[r("div",{staticClass:"vat-input-container",staticStyle:{display:"flex","justify-content":"center","align-items":"center",margin:"0 auto"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.companyVAT,expression:"currentProposal.companyVAT"}],staticClass:"kam-input",staticStyle:{width:"400px","font-size":"18px",padding:"10px"},attrs:{id:"companyVAT",type:"text",placeholder:"Organisasjonsnummer",required:""},domProps:{value:o.currentProposal.companyVAT},on:{keyup:function(e){return!e.type.indexOf("key")&&o._k(e.keyCode,"enter",13,e.key,"Enter")?null:o.lookupCompanyInfo.apply(null,arguments)},input:function(e){e.target.composing||o.$set(o.currentProposal,"companyVAT",e.target.value)}}}),o._v(" "),r("button",{staticClass:"emoji-btn lookup-btn",staticStyle:{height:"44px","font-size":"18px",padding:"10px","margin-left":"10px"},attrs:{disabled:o.isLookingUp},on:{click:o.lookupCompanyInfo}},[o._v("\n                  "+o._s(o.isLookingUp?"Søker...":"Søk")+"\n                ")])])])]):o._e(),o._v(" "),2===o.proposalStep?r("form",{on:{submit:function(e){return e.preventDefault(),o.saveProposal.apply(null,arguments)}}},[r("div",{staticClass:"form-section"},[r("h6",{staticClass:"section-title"},[o._v("Kundeinformasjon")]),o._v(" "),r("div",{staticClass:"form-row"},[r("div",{staticClass:"form-group form-group--half"},[r("label",{attrs:{for:"clientName"}},[o._v("Navn på kontaktperson *")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.clientName,expression:"currentProposal.clientName"}],staticClass:"kam-input",attrs:{id:"clientName",type:"text",required:""},domProps:{value:o.currentProposal.clientName},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"clientName",e.target.value)}}})]),o._v(" "),r("div",{staticClass:"form-group form-group--half"},[r("label",{attrs:{for:"clientPhoneNumber"}},[o._v("Telefonnummer *")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.clientPhoneNumber,expression:"currentProposal.clientPhoneNumber"}],staticClass:"kam-input",attrs:{id:"clientPhoneNumber",type:"tel",required:""},domProps:{value:o.currentProposal.clientPhoneNumber},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"clientPhoneNumber",e.target.value)}}})])]),o._v(" "),r("div",{staticClass:"form-row"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"clientEmail"}},[o._v("E-post")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.clientEmail,expression:"currentProposal.clientEmail"}],staticClass:"kam-input",attrs:{id:"clientEmail",type:"email"},domProps:{value:o.currentProposal.clientEmail},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"clientEmail",e.target.value)}}})])])]),o._v(" "),r("div",{staticClass:"form-section"},[r("h6",{staticClass:"section-title"},[o._v("Firmainformasjon")]),o._v(" "),r("div",{staticClass:"form-row"},[r("div",{staticClass:"form-group form-group--half"},[r("label",{attrs:{for:"companyLegalName"}},[o._v("Firmanavn *")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.companyLegalName,expression:"currentProposal.companyLegalName"}],staticClass:"kam-input",attrs:{id:"companyLegalName",type:"text",required:""},domProps:{value:o.currentProposal.companyLegalName},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"companyLegalName",e.target.value)}}})]),o._v(" "),r("div",{staticClass:"form-group form-group--half"},[r("label",{attrs:{for:"companyVAT"}},[o._v("Organisasjonsnummer *")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.companyVAT,expression:"currentProposal.companyVAT"}],staticClass:"kam-input",attrs:{id:"companyVAT",type:"text",required:""},domProps:{value:o.currentProposal.companyVAT},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"companyVAT",e.target.value)}}})])]),o._v(" "),r("div",{staticClass:"form-row"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"companyFullAddress"}},[o._v("Adresse")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.companyFullAddress,expression:"currentProposal.companyFullAddress"}],staticClass:"kam-input",attrs:{id:"companyFullAddress",type:"text"},domProps:{value:o.currentProposal.companyFullAddress},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"companyFullAddress",e.target.value)}}})])]),o._v(" "),r("div",{staticClass:"form-row"},[r("div",{staticClass:"form-group form-group--half"},[r("label",{attrs:{for:"companyZipCode"}},[o._v("Postnummer")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.companyZipCode,expression:"currentProposal.companyZipCode"}],staticClass:"kam-input",attrs:{id:"companyZipCode",type:"text"},domProps:{value:o.currentProposal.companyZipCode},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"companyZipCode",e.target.value)}}})]),o._v(" "),r("div",{staticClass:"form-group form-group--half"},[r("label",{attrs:{for:"companyCity"}},[o._v("Sted")]),o._v(" "),r("br"),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:o.currentProposal.companyCity,expression:"currentProposal.companyCity"}],staticClass:"kam-input",attrs:{id:"companyCity",type:"text"},domProps:{value:o.currentProposal.companyCity},on:{input:function(e){e.target.composing||o.$set(o.currentProposal,"companyCity",e.target.value)}}})])])]),o._v(" "),r("div",{staticClass:"form-section"},[r("h6",{staticClass:"section-title"},[o._v("Varer og tjenester")]),o._v(" "),r("div",{staticClass:"offer-items-selection"},[o._l(o.offerItems,(function(e){return r("div",{key:e.offerItemId,staticClass:"offer-item-checkbox"},[r("div",{staticClass:"custom-checkbox"},[r("input",{directives:[{name:"model",rawName:"v-model",value:o.selectedOfferItems,expression:"selectedOfferItems"}],staticClass:"custom-checkbox-input",attrs:{id:"item-"+e.offerItemId,type:"checkbox"},domProps:{value:e.offerItemId,checked:Array.isArray(o.selectedOfferItems)?o._i(o.selectedOfferItems,e.offerItemId)>-1:o.selectedOfferItems},on:{change:[function(t){var r=o.selectedOfferItems,n=t.target,l=!!n.checked;if(Array.isArray(r)){var c=e.offerItemId,d=o._i(r,c);n.checked?d<0&&(o.selectedOfferItems=r.concat([c])):d>-1&&(o.selectedOfferItems=r.slice(0,d).concat(r.slice(d+1)))}else o.selectedOfferItems=l},o.updateLineItems]}}),o._v(" "),r("label",{staticClass:"custom-checkbox-label",attrs:{for:"item-"+e.offerItemId}})]),o._v(" "),r("label",{attrs:{for:"item-"+e.offerItemId}},[o._v(" "+o._s(e.name)+" ")]),o._v(" "),o.isItemSelected(e.offerItemId)?r("div",{staticClass:"quantity-selector"},[r("div",{staticClass:"price-input-group"},[r("label",{attrs:{for:"quantity-"+e.offerItemId}},[o._v("Antall:")]),o._v(" "),r("input",{directives:[{name:"model",rawName:"v-model.number",value:o.lineItems[e.offerItemId].quantity,expression:"lineItems[item.offerItemId].quantity",modifiers:{number:!0}}],staticClass:"quantity-input",attrs:{id:"quantity-"+e.offerItemId,type:"number",min:"1"},domProps:{value:o.lineItems[e.offerItemId].quantity},on:{input:function(t){t.target.composing||o.$set(o.lineItems[e.offerItemId],"quantity",o._n(t.target.value))},blur:function(e){return o.$forceUpdate()}}})]),o._v(" "),e.enableMonthlyFee?[r("div",{staticClass:"price-input-group"},[r("label",{attrs:{for:"monthlyFee-"+e.offerItemId}},[o._v("Mnd. pris:")]),o._v(" "),r("PriceInput",{staticClass:"price-input-wrapper",attrs:{id:"monthlyFee-"+e.offerItemId},model:{value:o.lineItems[e.offerItemId].monthlyFee,callback:function(t){o.$set(o.lineItems[e.offerItemId],"monthlyFee",t)},expression:"lineItems[item.offerItemId].monthlyFee"}})],1)]:o._e(),o._v(" "),e.enableOnetimeFee?[r("div",{staticClass:"price-input-group"},[r("label",{attrs:{for:"onetimeFee-"+e.offerItemId}},[o._v("Engangs:")]),o._v(" "),r("PriceInput",{staticClass:"price-input-wrapper",attrs:{id:"onetimeFee-"+e.offerItemId},model:{value:o.lineItems[e.offerItemId].onetimeFee,callback:function(t){o.$set(o.lineItems[e.offerItemId],"onetimeFee",t)},expression:"lineItems[item.offerItemId].onetimeFee"}})],1)]:o._e()],2):o._e()])})),o._v(" "),0===o.offerItems.length?r("div",{staticClass:"no-items-message"},[o._v("\n                  Ingen varer eller tjenester tilgjengelig\n                ")]):o._e()],2)]),o._v(" "),r("div",{staticClass:"modal-buttons"},[r("input",{staticClass:"emoji-btn cancel-btn",attrs:{type:"button",value:"Avbryt"},on:{click:o.closeProposalModal}}),o._v(" "),r("input",{staticClass:"emoji-btn save-btn",attrs:{type:"submit",value:"Lagre",disabled:!o.isProposalValid||o.isSubmitting}})])]):o._e()])]):o._e(),o._v(" "),o.showViewProposalModal?r("Modal",{attrs:{wide:!0},on:{close:o.closeViewProposalModal}},[r("div",{staticStyle:{width:"900px","max-width":"90vw",margin:"0 auto"}},[o.viewingProposal?r("div",[r("div",{staticClass:"preview-container"},[r("div",{staticClass:"scrollable-document-container"},[r("OfferDocument",{attrs:{"offer-proposal":o.viewingProposal}})],1)]),o._v(" "),r("div",{staticClass:"modal-buttons"},[r("button",{staticClass:"emoji-btn",on:{click:o.closeViewProposalModal}},[o._v("\n                Lukk\n              ")]),o._v(" "),!o.viewingProposal||"Created"!==o.viewingProposal.status&&"Sent"!==o.viewingProposal.status?o._e():r("button",{staticClass:"emoji-btn",on:{click:o.editViewingProposal}},[o._v("\n                Endre\n              ")]),o._v(" "),o.viewingProposal&&o.viewingProposal.clientPhoneNumber&&("Created"===o.viewingProposal.status||"Sent"===o.viewingProposal.status||"Read"===o.viewingProposal.status)?r("button",{staticClass:"emoji-btn save-btn",attrs:{disabled:o.isSendingSms},on:{click:o.sendProposalSms}},[o._v("\n                "+o._s("Created"===o.viewingProposal.status?"Send SMS":"Send ny SMS")+"\n              ")]):o._e(),o._v(" "),o.viewingProposal&&o.viewingProposal.clientEmail&&("Created"===o.viewingProposal.status||"Sent"===o.viewingProposal.status||"Read"===o.viewingProposal.status)?r("button",{staticClass:"emoji-btn save-btn",attrs:{disabled:o.isSendingEmail},on:{click:o.sendProposalEmail}},[o._v("\n                "+o._s("Created"===o.viewingProposal.status?"Send E-post":"Send ny E-post")+"\n              ")]):o._e()])]):o._e()])]):o._e(),o._v(" "),o.showDeleteProposalModal?r("Modal",{attrs:{wide:!0},on:{close:o.closeDeleteProposalModal}},[r("div",{staticStyle:{width:"500px","max-width":"90vw",margin:"0 auto","text-align":"center"}},[r("h1",{staticStyle:{"margin-bottom":"1em"}},[o._v("Bekreft sletting")]),o._v(" "),r("p",[o._v("\n            Er du sikker på at du vil slette avtalen for "),r("strong",[o._v(o._s(null===(e=o.proposalToDelete)||void 0===e?void 0:e.clientName))]),o._v("?\n          ")]),o._v(" "),r("div",{staticClass:"modal-buttons"},[r("input",{staticClass:"emoji-btn cancel-btn",attrs:{type:"button",value:"Avbryt"},on:{click:o.closeDeleteProposalModal}}),o._v(" "),r("input",{staticClass:"emoji-btn action-button--reject",attrs:{type:"button",value:"Slett"},on:{click:o.confirmDeleteProposal}})])])]):o._e(),o._v(" "),o.showCancelProposalModal?r("Modal",{attrs:{wide:!0},on:{close:o.closeCancelProposalModal}},[r("div",{staticStyle:{width:"500px","max-width":"90vw",margin:"0 auto","text-align":"center"}},[r("h1",{staticStyle:{"margin-bottom":"1em"}},[o._v("Bekreft oppsigelse")]),o._v(" "),r("p",[o._v("\n            Er du sikker på at du vil si opp avtalen for "),r("strong",[o._v(o._s(null===(t=o.proposalToCancel)||void 0===t?void 0:t.clientName))]),o._v("?\n          ")]),o._v(" "),r("div",{staticClass:"modal-buttons"},[r("input",{staticClass:"emoji-btn cancel-btn",attrs:{type:"button",value:"Avbryt"},on:{click:o.closeCancelProposalModal}}),o._v(" "),r("input",{staticClass:"emoji-btn action-button--cancel",attrs:{type:"button",value:"Si opp"},on:{click:o.confirmCancelProposal}})])])]):o._e()],1)])])}),[],!1,null,"7f61d4e0",null);t.default=component.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{560:function(e,t,r){var content=r(721);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(120).default)("349ee142",content,!0,{sourceMap:!1})},720:function(e,t,r){"use strict";r(560)},721:function(e,t,r){var n=r(119)((function(i){return i[1]}));n.push([e.i,".overview__header[data-v-ab4327c4]{align-items:center;display:flex;justify-content:space-between;margin-bottom:1rem}.overview__button[data-v-ab4327c4]{background-color:#333;border:none;border-radius:.25rem;color:#fff;cursor:pointer;padding:.5rem 1rem}.overview__button[data-v-ab4327c4]:hover{background-color:#555}.overview__table-container[data-v-ab4327c4]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px rgba(0,0,0,.1);margin-bottom:1.5rem;padding:1.5rem}.overview__table[data-v-ab4327c4]{border-collapse:collapse;width:100%}.overview__table td[data-v-ab4327c4],.overview__table th[data-v-ab4327c4]{border-bottom:1px solid #e2e8f0;padding:.75rem;text-align:left}.overview__table th[data-v-ab4327c4]{color:#4a5568;font-weight:600}.overview__table tbody tr[data-v-ab4327c4]:hover{background-color:#f7fafc}.overview__empty[data-v-ab4327c4]{color:#a0aec0;padding:2rem 0;text-align:center}.action-buttons[data-v-ab4327c4]{display:flex;gap:.5rem}.action-button[data-v-ab4327c4]{border:none;border-radius:.25rem;cursor:pointer;font-size:.75rem;padding:.25rem .5rem}.action-button--edit[data-v-ab4327c4]{background-color:#ebf8ff;color:#333}.action-button--edit[data-v-ab4327c4]:hover{background-color:#bee3f8}.action-button--reject[data-v-ab4327c4]{background-color:#fed7d7;color:#c53030}.action-button--reject[data-v-ab4327c4]:hover{background-color:#feb2b2}.form-group[data-v-ab4327c4]{margin-bottom:1.5rem;text-align:left}.form-group label[data-v-ab4327c4]{color:#4a5568;display:inline-block;font-weight:500;margin-bottom:.5rem}.form-select[data-v-ab4327c4]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E\");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;border:1px solid #e2e8f0;border-radius:.375rem;padding:.625rem .75rem;transition:all .2s;width:100%}.form-select[data-v-ab4327c4]:focus{border-color:#333;box-shadow:0 0 0 3px rgba(59,130,246,.1);outline:none}.modal-buttons[data-v-ab4327c4]{display:flex;gap:1rem;justify-content:center;margin-top:2rem}.emoji-btn[data-v-ab4327c4]{background:#fff;border:1px solid #e2e8f0;border-radius:.375rem;cursor:pointer;font-weight:500;min-width:120px;padding:.625rem 1.25rem;transition:all .2s}.emoji-btn[data-v-ab4327c4]:hover{background:#f8fafc;border-color:#cbd5e1}.emoji-btn.save-btn[data-v-ab4327c4]{background-color:#4a5568;border-color:#4a5568;color:#fff}.emoji-btn.save-btn[data-v-ab4327c4]:hover{background-color:#2d3748}.emoji-btn.save-btn[data-v-ab4327c4]:disabled{background-color:#a0aec0;border-color:#a0aec0;cursor:not-allowed}.visible-loader[data-v-ab4327c4]{align-items:center;background-color:hsla(0,0%,100%,.7);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:1000}.loader-content[data-v-ab4327c4]{background-color:#fff;border-radius:.5rem;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:2rem;text-align:center}.spinner[data-v-ab4327c4]{animation:spin-ab4327c4 1s ease-in-out infinite;border:3px solid rgba(0,0,0,.1);border-radius:50%;border-top-color:#333;display:inline-block;height:2rem;margin-bottom:.5rem;width:2rem}@keyframes spin-ab4327c4{to{transform:rotate(1turn)}}",""]),n.locals={},e.exports=n},838:function(e,t,r){"use strict";r.r(t);r(27),r(50),r(41),r(13);var n=r(0),o=(r(9),r(73),r(30),r(31),r(494)),c=r(502),l={components:{AdminPage:o.default,Modal:c.default},data:function(){return{relationships:[],kamUsers:[],isLoading:!1,showAssignModal:!1,showUnassignModal:!1,isEditMode:!1,currentAssignment:{kamId:"",directorId:""},selectedKamId:"",refreshInterval:null}},computed:{isPowerUser:function(){var e;return null===(e=this.$store.state)||void 0===e||null===(e=e.currentUser)||void 0===e?void 0:e.isPowerUser}},mounted:function(){var e=this;this.isPowerUser?(this.fetchData(),this.refreshInterval=setInterval((function(){e.fetchDataInBackground()}),3e4)):this.$router.push("/admin")},beforeDestroy:function(){this.refreshInterval&&clearInterval(this.refreshInterval)},methods:{fetchData:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.prev=1,t.next=4,Promise.all([e.fetchRelationships(),e.fetchKamUsers()]);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(1),console.error("Error fetching data:",t.t0),alert("Kunne ikke laste data. Vennligst prøv igjen.");case 10:return t.prev=10,e.isLoading=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[1,6,10,13]])})))()},fetchDataInBackground:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([e.fetchRelationships(),e.fetchKamUsers()]);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Error refreshing data:",t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},fetchRelationships:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e._kamService.GetKamDirectorRelationships();case 3:e.relationships=t.sent,t.next=10;break;case 6:throw t.prev=6,t.t0=t.catch(0),console.error("Error fetching relationships:",t.t0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))()},fetchKamUsers:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e._kamService.GetAllKeyAccountManagers();case 3:e.kamUsers=t.sent,t.next=10;break;case 6:throw t.prev=6,t.t0=t.catch(0),console.error("Error fetching KAM users:",t.t0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))()},showAssignManagerModal:function(){this.isEditMode=!1,this.currentAssignment={kamId:"",directorId:""},this.showAssignModal=!0},editRelationship:function(e){this.isEditMode=!0,this.currentAssignment={kamId:e.keyAccountManager.id,directorId:e.director.id},this.showAssignModal=!0},confirmUnassignManager:function(e){this.selectedKamId=e.keyAccountManager.id,this.showUnassignModal=!0},closeAssignModal:function(){this.showAssignModal=!1},closeUnassignModal:function(){this.showUnassignModal=!1,this.selectedKamId=""},saveAssignment:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.currentAssignment.kamId&&e.currentAssignment.directorId){t.next=3;break}return alert("Vennligst velg både en Key Account Manager og en Direktør"),t.abrupt("return");case 3:return e.isLoading=!0,t.prev=4,t.next=7,e._kamService.AssignManager(e.currentAssignment.kamId,e.currentAssignment.directorId);case 7:if(!t.sent){t.next=14;break}return e.closeAssignModal(),t.next=12,e.fetchRelationships();case 12:t.next=15;break;case 14:alert("Kunne ikke lagre tildelingen. Vennligst prøv igjen.");case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),console.error("Error saving assignment:",t.t0),alert("En feil oppstod under lagring. Vennligst prøv igjen.");case 21:return t.prev=21,e.isLoading=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[4,17,21,24]])})))()},unassignManager:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectedKamId){t.next=3;break}return alert("Ingen Key Account Manager valgt"),t.abrupt("return");case 3:return e.isLoading=!0,t.prev=4,t.next=7,e._kamService.UnassignManager(e.selectedKamId);case 7:if(!t.sent){t.next=14;break}return e.closeUnassignModal(),t.next=12,e.fetchRelationships();case 12:t.next=15;break;case 14:alert("Kunne ikke fjerne direktøren. Vennligst prøv igjen.");case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),console.error("Error unassigning manager:",t.t0),alert("En feil oppstod under fjerning av direktøren. Vennligst prøv igjen.");case 21:return t.prev=21,e.isLoading=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[4,17,21,24]])})))()}}},d=(r(720),r(78)),component=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("AdminPage",{attrs:{"full-width":!0}},[t("div",{staticClass:"overview"},[t("div",{staticClass:"overview__content"},[t("div",{staticClass:"overview__table-container"},[t("div",{staticClass:"overview__header"},[t("h3",[e._v("KAM-Direktør Relasjoner")]),e._v(" "),t("button",{staticClass:"overview__button",on:{click:e.showAssignManagerModal}},[e._v("\n            Tildel Direktør til KAM\n          ")])]),e._v(" "),t("table",{staticClass:"overview__table"},[t("thead",[t("tr",[t("th",{staticClass:"sortable-header"},[e._v("Key Account Manager")]),e._v(" "),t("th",{staticClass:"sortable-header"},[e._v("Telefonnummer")]),e._v(" "),t("th",{staticClass:"sortable-header"},[e._v("Direktør")]),e._v(" "),t("th",{staticClass:"sortable-header"},[e._v("Direktør Telefon")]),e._v(" "),t("th",[e._v("Handlinger")])])]),e._v(" "),t("tbody",[e._l(e.relationships,(function(r,n){return t("tr",{key:n},[t("td",[e._v(e._s(r.keyAccountManager.name))]),e._v(" "),t("td",[e._v(e._s(r.keyAccountManager.phoneNumber))]),e._v(" "),t("td",[e._v(e._s(r.director.name))]),e._v(" "),t("td",[e._v(e._s(r.director.phoneNumber))]),e._v(" "),t("td",[t("div",{staticClass:"action-buttons"},[t("button",{staticClass:"action-button action-button--edit",on:{click:function(t){return e.editRelationship(r)}}},[e._v("\n                    Endre\n                  ")]),e._v(" "),t("button",{staticClass:"action-button action-button--reject",on:{click:function(t){return e.confirmUnassignManager(r)}}},[e._v("\n                    Fjern\n                  ")])])])])})),e._v(" "),0===e.relationships.length?t("tr",[t("td",{staticClass:"overview__empty",attrs:{colspan:"5"}},[e._v("\n                Ingen KAM-Direktør relasjoner funnet\n              ")])]):e._e()],2)])]),e._v(" "),e.showAssignModal?t("Modal",{attrs:{wide:!0},on:{close:e.closeAssignModal}},[t("div",{staticStyle:{width:"600px","max-width":"90vw",margin:"0 auto","text-align":"center"}},[t("h1",{staticStyle:{"margin-bottom":"1em"}},[e._v("\n            "+e._s(e.isEditMode?"Endre KAM-Direktør Relasjon":"Tildel Direktør til KAM")+"\n          ")]),e._v(" "),t("form",{on:{submit:function(t){return t.preventDefault(),e.saveAssignment.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"kamSelect"}},[e._v("Key Account Manager")]),e._v(" "),t("br"),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.currentAssignment.kamId,expression:"currentAssignment.kamId"}],staticClass:"form-select",attrs:{id:"kamSelect",required:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.currentAssignment,"kamId",t.target.multiple?r:r[0])}}},[t("option",{attrs:{value:"",disabled:""}},[e._v("\n                  Velg en Key Account Manager\n                ")]),e._v(" "),e._l(e.kamUsers,(function(r){return t("option",{key:r.id,domProps:{value:r.id}},[e._v("\n                  "+e._s(r.name)+" ("+e._s(r.phoneNumber)+")\n                ")])}))],2)]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"directorSelect"}},[e._v("Direktør")]),e._v(" "),t("br"),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.currentAssignment.directorId,expression:"currentAssignment.directorId"}],staticClass:"form-select",attrs:{id:"directorSelect",required:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.currentAssignment,"directorId",t.target.multiple?r:r[0])}}},[t("option",{attrs:{value:"",disabled:""}},[e._v("\n                  Velg en Direktør\n                ")]),e._v(" "),e._l(e.kamUsers,(function(r){return t("option",{key:r.id,domProps:{value:r.id}},[e._v("\n                  "+e._s(r.name)+" ("+e._s(r.phoneNumber)+")\n                ")])}))],2)]),e._v(" "),t("div",{staticClass:"modal-buttons"},[t("input",{staticClass:"emoji-btn",attrs:{type:"button",value:"Avbryt"},on:{click:e.closeAssignModal}}),e._v(" "),t("input",{staticClass:"emoji-btn save-btn",attrs:{type:"submit",value:"Lagre",disabled:e.isLoading}})])])])]):e._e(),e._v(" "),e.showUnassignModal?t("Modal",{attrs:{wide:!0},on:{close:e.closeUnassignModal}},[t("div",{staticStyle:{width:"500px","max-width":"90vw",margin:"0 auto","text-align":"center"}},[t("h1",{staticStyle:{"margin-bottom":"1em"}},[e._v("Bekreft Fjerning")]),e._v(" "),t("p",[e._v("\n            Er du sikker på at du vil fjerne direktøren fra denne Key Account Manager?\n          ")]),e._v(" "),t("div",{staticClass:"modal-buttons"},[t("input",{staticClass:"emoji-btn",attrs:{type:"button",value:"Avbryt"},on:{click:e.closeUnassignModal}}),e._v(" "),t("input",{staticClass:"emoji-btn action-button--reject",attrs:{type:"button",value:"Fjern"},on:{click:e.unassignManager}})])])]):e._e(),e._v(" "),e.isLoading?t("div",{staticClass:"visible-loader"},[t("div",{staticClass:"loader-content"},[t("div",{staticClass:"spinner"}),e._v(" "),t("p",[e._v("Laster...")])])]):e._e()],1)])])}),[],!1,null,"ab4327c4",null);t.default=component.exports}}]);
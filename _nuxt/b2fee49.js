(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{552:function(e,t,n){var content=n(676);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(120).default)("d466acf2",content,!0,{sourceMap:!1})},675:function(e,t,n){"use strict";n(552)},676:function(e,t,n){var r=n(119)((function(i){return i[1]}));r.push([e.i,'.dinehome-page[data-v-782a3d50]{margin:0 auto;max-width:1200px;padding:24px}@media(max-width:768px){.dinehome-page[data-v-782a3d50]{padding:8px}}.date-picker-section[data-v-782a3d50]{margin-bottom:32px;text-align:center}.date-picker-section h2[data-v-782a3d50]{color:#292c34;margin-bottom:24px}.date-picker-container[data-v-782a3d50]{display:flex;justify-content:center}.date-picker-wrapper[data-v-782a3d50]{align-items:center;background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);display:flex;gap:16px;padding:20px}@media(max-width:768px){.date-picker-wrapper[data-v-782a3d50]{border-radius:0;box-shadow:none;flex-direction:column;margin:0 -8px;max-width:none;width:100%}}.date-input[data-v-782a3d50]{display:flex;flex-direction:column;gap:8px}.date-input label[data-v-782a3d50]{color:#4a5568;font-weight:500}.date-input input[data-v-782a3d50]{border:2px solid #e2e8f0;border-radius:8px;font-size:.95em;padding:8px 12px;transition:all .2s ease}.date-input input[data-v-782a3d50]:focus{border-color:#1bb776;box-shadow:0 0 0 3px rgba(27,183,118,.1);outline:none}.delivery-times-table[data-v-782a3d50]{background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);overflow-x:auto}@media(max-width:768px){.delivery-times-table[data-v-782a3d50]{-webkit-overflow-scrolling:touch;border-radius:0;display:block;margin:0 -8px;overflow-x:auto;position:relative;white-space:nowrap}}.delivery-time-row[data-v-782a3d50]{grid-gap:16px;align-items:center;background:#fff;display:grid;gap:16px;grid-template-columns:minmax(160px,1.5fr) minmax(70px,.8fr) minmax(130px,1.2fr) minmax(130px,1.2fr) minmax(130px,1.2fr) minmax(100px,1fr);padding:12px 20px}@media(max-width:768px){.delivery-time-row[data-v-782a3d50]{gap:12px;grid-template-columns:minmax(180px,2fr) minmax(50px,.5fr) minmax(130px,1.2fr) minmax(130px,1.2fr) minmax(130px,1.2fr) minmax(100px,1fr);padding:12px 16px}}.delivery-time-row[data-v-782a3d50]:not(.header):hover{background:#f8fafc}.delivery-time-row .col[data-v-782a3d50]{overflow:hidden;position:relative;text-overflow:ellipsis;white-space:nowrap}.delivery-time-row .col.sortable[data-v-782a3d50]{cursor:pointer}.delivery-time-row.header[data-v-782a3d50]{background:#fff;border-bottom:1px solid #e2e8f0;font-weight:500;position:sticky;top:0;z-index:1}.empty-state[data-v-782a3d50]{background:#f8f9fa;border-radius:12px;color:#718096;font-style:italic;margin-top:24px;padding:48px;text-align:center}.sort-icon[data-v-782a3d50]{color:#1bb776;font-size:14px}.clickable[data-v-782a3d50]{cursor:pointer}.clickable[data-v-782a3d50]:hover{color:#1bb776}.resize-handle[data-v-782a3d50]{bottom:0;cursor:col-resize;position:absolute;right:-8px;top:0;width:16px;z-index:2}.resize-handle[data-v-782a3d50]:active:after,.resize-handle[data-v-782a3d50]:hover:after{background:#1bb776;bottom:0;content:"";position:absolute;right:8px;top:0;width:2px}.resize-handle[data-v-782a3d50]:active:after{background:#159c63}.resizing[data-v-782a3d50]{-moz-user-select:none;user-select:none;-webkit-user-select:none}.resizing *[data-v-782a3d50]{cursor:col-resize!important}.delivery-count[data-v-782a3d50]{color:#4a5568;font-weight:500;margin-bottom:16px;text-align:center}.date-nav-btn[data-v-782a3d50]{align-items:center;background:none;border:none;border-radius:8px;color:#4a5568;cursor:pointer;display:flex;font-size:1.5em;justify-content:center;padding:8px;transition:all .2s ease}.date-nav-btn[data-v-782a3d50]:hover{background:#f7fafc;color:#1bb776}.date-nav-btn[data-v-782a3d50]:active{transform:scale(.95)}.date-nav-btn[data-v-782a3d50]:focus{box-shadow:0 0 0 3px rgba(27,183,118,.1);outline:none}',""]),r.locals={},e.exports=r},834:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(79),d=(n(9),n(308),n(57),n(307),n(50),n(97),n(42),n(13),n(33),n(73),n(494)),c=n(495),l=n(497),m={components:{AdminPage:d.default,LoginModal:l.default,Loading:c.default},data:function(){return{showLogin:!1,isLoading:!1,deliveryTimes:[],selectedDate:(new Date).toISOString().split("T")[0],sortField:"drivingTimeInMinutes",sortDirection:"desc",showActualTime:!1,columnWidths:[160,70,130,130,130,100],resizing:null,isResizing:!1}},computed:{sortedDeliveryTimes:function(){var e=this;return Object(o.a)(this.deliveryTimes).sort((function(a,b){var t=a[e.sortField],n=b[e.sortField];if("drivingTimeInMinutes"===e.sortField)t=e.calculateActualDrivingTime(a),n=e.calculateActualDrivingTime(b);else if("processingEndTime"===e.sortField){var r=function(time){return time&&time.estimatedProcessingEndTime&&time.processingEndTime&&"0001-01-01T00:00:00"!==time.processingEndTime?Math.round((new Date(time.processingEndTime)-new Date(time.estimatedProcessingEndTime))/6e4):null};if(t=r(a),n=r(b),null===t)return 1;if(null===n)return-1}else["estimatedProcessingEndTime","completedTime"].includes(e.sortField)?(t=t&&"0001-01-01T00:00:00"!==t?new Date(t).getTime():0,n=n&&"0001-01-01T00:00:00"!==n?new Date(n).getTime():0):"drivingTimeInMinutes"===e.sortField?(t=Number(t),n=Number(n)):(t=t||"",n=n||"");return"asc"===e.sortDirection?t>n?1:t<n?-1:0:t<n?1:t>n?-1:0}))},isFutureOrToday:function(){var e=new Date;return e.setHours(0,0,0,0),new Date(this.selectedDate)>=e}},mounted:function(){this.$store.getters.userIsLoggedIn?this.fetchDeliveryTimes():this.showLogin=!0},beforeDestroy:function(){window.removeEventListener("mousemove",this.handleResize),window.removeEventListener("mouseup",this.stopResize)},methods:{closeLoginModal:function(e){this.showLogin=!e,e&&this.fetchDeliveryTimes()},fetchDeliveryTimes:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.prev=1,n=e.$store.state.currentUser.adminIn.map((function(e){return e.id})),r={dateFrom:new Date(e.selectedDate),dateTo:new Date(e.selectedDate),storeIds:n},t.next=6,e._dineHomeService.getDeliveryTimes(r);case 6:e.deliveryTimes=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Failed to fetch delivery times:",t.t0);case 12:return t.prev=12,e.isLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[1,9,12,15]])})))()},formatDate:function(e){return e&&"0001-01-01T00:00:00"!==e?new Date(e).toLocaleString("no-NO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):null},getTimeDiff:function(e,t){if(!e||!t||"0001-01-01T00:00:00"===t)return"-";var n=Math.round((new Date(t)-new Date(e))/6e4);return 0===n?"Presist":n>0?"".concat(n," min senere"):"".concat(Math.abs(n)," min tidligere")},handleColumnClick:function(e,t){this.isResizing||this.sort(t)},startResize:function(e,t){e.stopPropagation(),this.isResizing=!0,this.resizing={columnIndex:t,startX:e.pageX,startWidth:this.columnWidths[t]},window.addEventListener("mousemove",this.handleResize),window.addEventListener("mouseup",this.stopResize)},handleResize:function(e){if(this.resizing){var t=e.pageX-this.resizing.startX,n=Math.max(50,this.resizing.startWidth+t);this.columnWidths[this.resizing.columnIndex]=n;var r=this.columnWidths.map((function(e){return"minmax(".concat(e,"px, ").concat(e,"fr)")})).join(" ");document.querySelectorAll(".delivery-time-row").forEach((function(e){e.style.gridTemplateColumns=r}))}},stopResize:function(){var e=this;this.resizing=null,setTimeout((function(){e.isResizing=!1}),150),window.removeEventListener("mousemove",this.handleResize),window.removeEventListener("mouseup",this.stopResize)},sort:function(e){this.sortField===e?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortField=e,this.sortDirection="asc")},toggleTimeDisplay:function(){this.showActualTime=!this.showActualTime},calculateActualDrivingTime:function(time){if(!time.completedTime||!time.estimatedProcessingEndTime||!time.processingEndTime)return time.drivingTimeInMinutes||0;var e=new Date(time.completedTime),t=new Date(time.estimatedProcessingEndTime),n=new Date(time.processingEndTime),r=n>t?n:t;return Math.round((e-r)/6e4)},handleDateChange:function(){this.fetchDeliveryTimes()},changeDate:function(e){var t=new Date(this.selectedDate);t.setDate(t.getDate()+e),this.selectedDate=t.toISOString().split("T")[0],this.fetchDeliveryTimes()}}},v=(n(675),n(78)),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("AdminPage",[t("div",{staticClass:"dinehome-page"},[t("div",{staticClass:"date-picker-section"},[t("h2",[e._v("DineHome leveringstider")]),e._v(" "),t("p",{staticStyle:{"margin-bottom":"1.5em"}},[e._v("\n        Her kan du se leveringstider fra DineHome for dine butikker.\n      ")]),e._v(" "),t("div",{staticClass:"date-picker-container"},[t("div",{staticClass:"date-picker-wrapper"},[t("button",{staticClass:"date-nav-btn",on:{click:function(t){return e.changeDate(-1)}}},[t("span",[e._v("←")])]),e._v(" "),t("div",{staticClass:"date-input"},[t("label",[e._v("Velg dato:")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedDate,expression:"selectedDate"}],attrs:{type:"date"},domProps:{value:e.selectedDate},on:{change:e.handleDateChange,input:function(t){t.target.composing||(e.selectedDate=t.target.value)}}})]),e._v(" "),t("button",{staticClass:"date-nav-btn",style:{visibility:e.isFutureOrToday?"hidden":"visible"},on:{click:function(t){return e.changeDate(1)}}},[t("span",[e._v("→")])])])])]),e._v(" "),e.deliveryTimes.length?t("div",{staticClass:"delivery-count"},[e._v("\n      Resultat: "+e._s(e.deliveryTimes.length)+" leveringer\n    ")]):e._e(),e._v(" "),e.isLoading?t("Loading",{attrs:{loading:!0}}):e.deliveryTimes.length?t("div",{staticClass:"delivery-times-table"},[t("div",{staticClass:"delivery-time-row header"},[t("div",{staticClass:"col store-name sortable",on:{click:function(t){return e.handleColumnClick(t,"storeName")}}},[e._v("\n          Butikk\n          "),"storeName"===e.sortField?t("span",{staticClass:"sort-icon"},[e._v("\n            "+e._s("asc"===e.sortDirection?"↑":"↓")+"\n          ")]):e._e(),e._v(" "),t("div",{staticClass:"resize-handle",on:{mousedown:function(t){return e.startResize(t,0)}}})]),e._v(" "),t("div",{staticClass:"col order-id sortable",on:{click:function(t){return e.handleColumnClick(t,"friendlyOrderId")}}},[e._v("\n          #\n          "),"friendlyOrderId"===e.sortField?t("span",{staticClass:"sort-icon"},[e._v("\n            "+e._s("asc"===e.sortDirection?"↑":"↓")+"\n          ")]):e._e(),e._v(" "),t("div",{staticClass:"resize-handle",on:{mousedown:function(t){return e.startResize(t,1)}}})]),e._v(" "),t("div",{staticClass:"col sortable",on:{click:function(t){return e.handleColumnClick(t,"estimatedProcessingEndTime")}}},[e._v("\n          Avtalt klar\n          "),"estimatedProcessingEndTime"===e.sortField?t("span",{staticClass:"sort-icon"},[e._v("\n            "+e._s("asc"===e.sortDirection?"↑":"↓")+"\n          ")]):e._e(),e._v(" "),t("div",{staticClass:"resize-handle",on:{mousedown:function(t){return e.startResize(t,2)}}})]),e._v(" "),t("div",{staticClass:"col sortable",on:{click:function(t){return e.handleColumnClick(t,"processingEndTime")}}},[e._v("\n          Faktisk klar\n          "),"processingEndTime"===e.sortField?t("span",{staticClass:"sort-icon"},[e._v("\n            "+e._s("asc"===e.sortDirection?"↑":"↓")+"\n          ")]):e._e(),e._v(" "),t("div",{staticClass:"resize-handle",on:{mousedown:function(t){return e.startResize(t,3)}}})]),e._v(" "),t("div",{staticClass:"col sortable",on:{click:function(t){return e.handleColumnClick(t,"completedTime")}}},[e._v("\n          Fullført\n          "),"completedTime"===e.sortField?t("span",{staticClass:"sort-icon"},[e._v("\n            "+e._s("asc"===e.sortDirection?"↑":"↓")+"\n          ")]):e._e(),e._v(" "),t("div",{staticClass:"resize-handle",on:{mousedown:function(t){return e.startResize(t,4)}}})]),e._v(" "),t("div",{staticClass:"col sortable",on:{click:function(t){return e.handleColumnClick(t,"drivingTimeInMinutes")}}},[e._v("\n          Leveringstid\n          "),"drivingTimeInMinutes"===e.sortField?t("span",{staticClass:"sort-icon"},[e._v("\n            "+e._s("asc"===e.sortDirection?"↑":"↓")+"\n          ")]):e._e(),e._v(" "),t("div",{staticClass:"resize-handle",on:{mousedown:function(t){return e.startResize(t,5)}}})])]),e._v(" "),e._l(e.sortedDeliveryTimes,(function(time){return t("div",{key:time.dineHomeOrderId,staticClass:"delivery-time-row"},[t("div",{staticClass:"col store-name"},[e._v("\n          "+e._s(time.storeName)+"\n        ")]),e._v(" "),t("div",{staticClass:"col order-id"},[e._v("\n          "+e._s(time.friendlyOrderId)+"\n        ")]),e._v(" "),t("div",{staticClass:"col"},[e._v("\n          "+e._s(e.formatDate(time.estimatedProcessingEndTime)||"-")+"\n        ")]),e._v(" "),t("div",{staticClass:"col clickable",on:{click:e.toggleTimeDisplay}},[e.showActualTime?t("span",[e._v("\n            "+e._s(e.formatDate(time.processingEndTime)||"-")+"\n          ")]):t("span",[e._v("\n            "+e._s(e.getTimeDiff(time.estimatedProcessingEndTime,time.processingEndTime))+"\n          ")])]),e._v(" "),t("div",{staticClass:"col"},[e._v("\n          "+e._s(e.formatDate(time.completedTime)||"-")+"\n        ")]),e._v(" "),t("div",{staticClass:"col"},[e._v(e._s(e.calculateActualDrivingTime(time))+" minutter")])])}))],2):e.isLoading?e._e():t("div",{staticClass:"empty-state"},[e._v("\n      Ingen leveringstider funnet i valgt periode. Har du ikke en DineHome-avtale? Kontakt hei@okam.no for å komme i gang.\n    ")]),e._v(" "),e.showLogin?t("LoginModal",{on:{close:e.closeLoginModal}}):e._e()],1)])}),[],!1,null,"782a3d50",null);t.default=component.exports}}]);
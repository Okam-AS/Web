(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{551:function(e,t,r){var content=r(674);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(120).default)("469d5144",content,!0,{sourceMap:!1})},673:function(e,t,r){"use strict";r(551)},674:function(e,t,r){var o=r(119)((function(i){return i[1]}));o.push([e.i,'.container{margin:0 auto;max-width:1200px;padding:2rem}.store-selector{margin-bottom:2rem}.store-selector .selector-container{align-items:center;display:flex}.store-selector .select-wrapper{min-width:300px;position:relative}.store-selector .select-wrapper select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border:1px solid #ddd;border-radius:4px;font-size:1rem;padding:.75rem 1rem;width:100%}.store-selector .select-wrapper select:focus{border-color:#06c;outline:none}.store-selector .select-wrapper:after{color:#666;content:"â–¼";font-size:.8rem;pointer-events:none;position:absolute;right:1rem;top:50%;transform:translateY(-50%)}.loading-container{align-items:center;display:flex;flex-direction:column;justify-content:center;padding:3rem}.loading-container i{color:#06c;font-size:2rem;margin-bottom:1rem}.error-container{background-color:#ffebee;border-radius:4px;color:#c62828;margin-bottom:1rem;padding:1rem}.no-categories{background-color:#f5f5f5;border-radius:4px;padding:2rem;text-align:center}.categories-container{background-color:#f8f9fa;border-radius:4px;padding:1rem}.categories-grid{grid-gap:1.5rem;display:grid;gap:1.5rem;grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}.category-card{background-color:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1);cursor:pointer;height:200px;overflow:hidden;position:relative;transition:transform .2s,box-shadow .2s}.category-card:hover{box-shadow:0 5px 15px rgba(0,0,0,.15);transform:translateY(-5px)}.category-card.hidden{opacity:.7}.category-image-container{align-items:center;background-color:#f5f5f5;display:flex;height:100%;justify-content:center;overflow:hidden;position:relative;width:100%}.category-image-container.dragging{background-color:rgba(0,102,204,.1);border:2px dashed #06c}.hidden-file-input{display:none}.loading-overlay{align-items:center;background-color:hsla(0,0%,100%,.7);bottom:0;display:flex;justify-content:center;left:0;position:absolute;right:0;top:0;z-index:10}.loading-overlay i{color:#06c;font-size:2rem}.category-image{height:100%;-o-object-fit:cover;object-fit:cover;width:100%}.category-image-placeholder{align-items:center;background-color:#e9ecef;color:#adb5bd;display:flex;flex-direction:column;height:100%;justify-content:center;left:0;position:absolute;top:0;width:100%}.category-image-placeholder svg{height:50px;margin-bottom:8px;width:50px}.upload-hint{color:#6c757d;display:block;font-size:.8rem;margin-top:8px;text-align:center}.category-overlay{background:linear-gradient(180deg,transparent 50%,rgba(0,0,0,.7));bottom:0;height:100%;left:0;position:absolute;right:0}.category-status-top{display:flex;flex-wrap:wrap;gap:.5rem;padding:.75rem;top:0}.category-details,.category-status-top{left:0;position:absolute;right:0;z-index:2}.category-details{bottom:0;padding:1rem}.category-name{color:#fff;font-size:1.1rem;font-weight:600;margin:0;text-shadow:0 1px 2px rgba(0,0,0,.5)}.status-badge{border-radius:4px;display:inline-block;font-size:.75rem;font-weight:500;padding:.25rem .5rem}.status-badge.hidden{background-color:rgba(233,236,239,.8);color:#6c757d}.status-badge.unpublished{background-color:rgba(255,243,205,.8);color:#856404}',""]),o.locals={},e.exports=o},833:function(e,t,r){"use strict";r.r(t);r(50),r(41),r(13),r(27);var o=r(0),n=(r(9),r(26),r(98),r(30),r(31),r(514),r(149),r(42),r(494)),c=r(93),l=r.n(c),d=r(6),m={components:{AdminPage:n.default},data:function(){return{selectedStore:null,categories:[],loading:!1,error:null,uploadingFor:null,draggingCategories:{},imageDimensions:{}}},watch:{selectedStore:function(e){e?this.loadCategories():this.categories=[]}},mounted:function(){this.$store.state.currentUser&&this.$store.state.currentUser.adminIn&&this.$store.state.currentUser.adminIn.length>0&&(this.selectedStore=this.$store.state.currentUser.adminIn[0].id)},methods:{handleDrop:function(e,t){var r=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var n,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if((n=e.dataTransfer.files[0]).type.match(/image\/(jpeg|png)/)){o.next=4;break}return alert("Only JPG and PNG files are allowed"),o.abrupt("return");case 4:if(!(n.size>5242880)){o.next=7;break}return alert("File size must be less than 5MB"),o.abrupt("return");case 7:return r.uploadingFor=t,o.prev=8,o.next=11,r.processImage(n);case 11:return c=o.sent,o.next=14,r.uploadImage(t,c);case 14:o.next=20;break;case 16:o.prev=16,o.t0=o.catch(8),console.error("Failed to upload image:",o.t0),alert("Failed to upload image");case 20:return o.prev=20,r.uploadingFor=null,r.draggingCategories[t]=!1,o.finish(20);case 24:case"end":return o.stop()}}),o,null,[[8,16,20,24]])})))()},triggerFileInput:function(e){var t=this.$refs["fileInput-".concat(e)];null!=t&&t[0]&&t[0].click()},handleFileSelect:function(e,t){var r=e.target.files[0];if(r){var o={dataTransfer:{files:[r]}};this.handleDrop(o,t),e.target.value=""}},processImage:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,img,canvas,o,n,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=URL.createObjectURL(e),img=new Image,t.next=4,new Promise((function(e,t){img.onload=e,img.onerror=t,img.src=r}));case 4:return canvas=document.createElement("canvas"),o=canvas.getContext("2d"),canvas.width=500,canvas.height=500,n=Math.min(img.width,img.height),c=(img.width-n)/2,l=(img.height-n)/2,o.drawImage(img,c,l,n,n,0,0,500,500),URL.revokeObjectURL(r),t.abrupt("return",new Promise((function(e){return canvas.toBlob(e,"image/jpeg",.9)})));case 14:case"end":return t.stop()}}),t)})))()},uploadImage:function(e,t){var r=this,o=new FormData;return o.append("image",t,"image.jpg"),o.append("guidId",e),l.a.post("".concat(d.a.okamApiBaseUrl,"/categories/").concat(e,"/image"),o,{headers:{Authorization:"Bearer ".concat(this.$store.state.currentUser.token)}}).then((function(){r.loadCategories(),r.$set(r.imageDimensions,e,"500x500")})).catch((function(e){console.error("Error uploading image:",e),alert("Failed to upload image: "+(e.message||"Unknown error"))}))},loadCategories:function(){var e=this;this.loading=!0,this.error=null,this._categoryService.GetAll(this.selectedStore,!0).then((function(t){e.categories=t,e.loading=!1})).catch((function(t){console.error("Error loading categories:",t),e.error="Kunne ikke laste kategorier: "+(t.message||"Ukjent feil"),e.loading=!1}))}}},f=(r(673),r(78)),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;return t("AdminPage",[t("div",{staticClass:"container"},[t("div",[t("h1",{staticStyle:{"margin-bottom":"0.5em"}},[e._v("Kategorier")]),e._v(" "),t("p",{staticStyle:{"margin-bottom":"1.5em"}},[e._v("Oversikt over kategorier for valgt butikk. For administrasjon av kategorier, bruk Okam Admin appen.")])]),e._v(" "),t("div",{staticClass:"store-selector"},[t("div",{staticClass:"selector-container"},[t("div",{staticClass:"select-wrapper"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedStore,expression:"selectedStore"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedStore=t.target.multiple?r:r[0]}}},e._l(e.$store.state.currentUser.adminIn,(function(option){return t("option",{key:option.id,domProps:{value:option.id}},[e._v("\n              "+e._s(option.name)+" ("+e._s(option.id)+")\n            ")])})),0)])])]),e._v(" "),e.loading?t("div",{staticClass:"loading-container"},[t("i",{staticClass:"fas fa-spinner fa-spin"}),e._v(" "),t("span",[e._v("Laster kategorier...")])]):e.error?t("div",{staticClass:"error-container"},[t("p",[e._v(e._s(e.error))])]):0===e.categories.length?t("div",{staticClass:"no-categories"},[t("p",[e._v("Ingen kategorier funnet for denne butikken.")])]):t("div",{staticClass:"categories-container"},[t("div",{staticClass:"categories-grid"},e._l(e.categories,(function(r){return t("div",{key:r.id,staticClass:"category-card",class:{hidden:r.hide}},[t("div",{staticClass:"category-image-container",class:{dragging:e.draggingCategories[r.id]},on:{dragover:function(t){t.preventDefault(),e.draggingCategories[r.id]=!0},dragleave:function(t){t.preventDefault(),e.draggingCategories[r.id]=!1},drop:function(t){return t.preventDefault(),e.handleDrop(t,r.id)},click:function(t){return e.triggerFileInput(r.id)}}},[t("input",{ref:"fileInput-".concat(r.id),refInFor:!0,staticClass:"hidden-file-input",attrs:{type:"file",accept:"image/jpeg,image/png"},on:{change:function(t){return e.handleFileSelect(t,r.id)}}}),e._v(" "),e.uploadingFor===r.id?t("div",{staticClass:"loading-overlay"},[t("i",{staticClass:"fas fa-spinner fa-spin"})]):e._e(),e._v(" "),r.image&&r.image.imageUrl?t("img",{staticClass:"category-image",attrs:{src:r.image.imageUrl,alt:r.name}}):t("div",{staticClass:"category-image-placeholder",staticStyle:{"pointer-events":"none"}},[t("svg",{attrs:{width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("rect",{attrs:{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"#adb5bd","stroke-width":"2"}}),e._v(" "),t("circle",{attrs:{cx:"8.5",cy:"8.5",r:"1.5",fill:"#adb5bd"}}),e._v(" "),t("path",{attrs:{d:"M6 16L9 13L11 15L15 11L18 14V16C18 17.1046 17.1046 18 16 18H8C6.89543 18 6 17.1046 6 16Z",fill:"#adb5bd"}})]),e._v(" "),t("span",{staticClass:"upload-hint"},[e._v("Klikk eller slipp bilde her")])]),e._v(" "),t("div",{staticClass:"category-overlay"}),e._v(" "),t("div",{staticClass:"category-status-top"},[r.hide?t("span",{staticClass:"status-badge hidden"},[e._v("Skjult")]):e._e(),e._v(" "),r.published&&r.image?e._e():t("span",{staticClass:"status-badge unpublished"},[e._v("Ikke publisert")])]),e._v(" "),t("div",{staticClass:"category-details"},[t("h3",{staticClass:"category-name"},[e._v("\n                "+e._s(r.name)+"\n              ")])])])])})),0)])])])}),[],!1,null,null,null);t.default=component.exports}}]);